var c=class{withFields(t){let r=Object.keys(this).map(n=>n in t?t[n]:this[n]);return new this.constructor(...r)}},T=class{static fromArray(t,r){let n=r||new Ue;for(let i=t.length-1;i>=0;--i)n=new me(t[i],n);return n}[Symbol.iterator](){return new Ot(this)}toArray(){return[...this]}atLeastLength(t){for(let r of this){if(t<=0)return!0;t--}return t<=0}hasLength(t){for(let r of this){if(t<=0)return!1;t--}return t===0}countLength(){let t=0;for(let r of this)t++;return t}};function h(e,t){return new me(e,t)}function u(e,t){return T.fromArray(e,t)}var Ot=class{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof Ue)return{done:!0};{let{head:t,tail:r}=this.#e;return this.#e=r,{value:t,done:!1}}}},Ue=class extends T{},me=class extends T{constructor(t,r){super(),this.head=t,this.tail=r}},He=class e{constructor(t){if(!(t instanceof Uint8Array))throw"BitArray can only be constructed from a Uint8Array";this.buffer=t}get length(){return this.buffer.length}byteAt(t){return this.buffer[t]}floatFromSlice(t,r,n){return En(this.buffer,t,r,n)}intFromSlice(t,r,n,i){return On(this.buffer,t,r,n,i)}binaryFromSlice(t,r){return new e(this.buffer.slice(t,r))}sliceAfter(t){return new e(this.buffer.slice(t))}};function On(e,t,r,n,i){let s=0;if(n)for(let o=t;o<r;o++)s=s*256+e[o];else for(let o=r-1;o>=t;o--)s=s*256+e[o];if(i){let l=2**((r-t)*8-1);s>=l&&(s-=l*2)}return s}function En(e,t,r,n){let i=new DataView(e.buffer),s=r-t;if(s===8)return i.getFloat64(t,!n);if(s===4)return i.getFloat32(t,!n);{let o=`Sized floats must be 32-bit or 64-bit on JavaScript, got size of ${s*8} bits`;throw new globalThis.Error(o)}}var he=class e extends c{static isResult(t){return t instanceof e}},f=class extends he{constructor(t){super(),this[0]=t}isOk(){return!0}},p=class extends he{constructor(t){super(),this[0]=t}isOk(){return!1}};function w(e,t){let r=[e,t];for(;r.length;){let n=r.pop(),i=r.pop();if(n===i)continue;if(!mr(n)||!mr(i)||!qn(n,i)||Tn(n,i)||Sn(n,i)||Cn(n,i)||Mn(n,i)||Nn(n,i)||Pn(n,i))return!1;let o=Object.getPrototypeOf(n);if(o!==null&&typeof o.equals=="function")try{if(n.equals(i))continue;return!1}catch{}let[l,a]=jn(n);for(let d of l(n))r.push(a(n,d),a(i,d))}return!0}function jn(e){if(e instanceof Map)return[t=>t.keys(),(t,r)=>t.get(r)];{let t=e instanceof globalThis.Error?["message"]:[];return[r=>[...t,...Object.keys(r)],(r,n)=>r[n]]}}function Tn(e,t){return e instanceof Date&&(e>t||e<t)}function Sn(e,t){return e.buffer instanceof ArrayBuffer&&e.BYTES_PER_ELEMENT&&!(e.byteLength===t.byteLength&&e.every((r,n)=>r===t[n]))}function Cn(e,t){return Array.isArray(e)&&e.length!==t.length}function Mn(e,t){return e instanceof Map&&e.size!==t.size}function Nn(e,t){return e instanceof Set&&(e.size!=t.size||[...e].some(r=>!t.has(r)))}function Pn(e,t){return e instanceof RegExp&&(e.source!==t.source||e.flags!==t.flags)}function mr(e){return typeof e=="object"&&e!==null}function qn(e,t){return typeof e!="object"&&typeof t!="object"&&(!e||!t)||[Promise,WeakSet,WeakMap,Function].some(n=>e instanceof n)?!1:e.constructor===t.constructor}function pe(e,t,r,n,i,s){let o=new globalThis.Error(i);o.gleam_error=e,o.module=t,o.line=r,o.function=n,o.fn=n;for(let l in s)o[l]=s[l];return o}var _=class extends c{constructor(t){super(),this[0]=t}},g=class extends c{};function hr(e,t){if(e instanceof _){let r=e[0];return new f(r)}else return new p(t)}function Et(e){if(e.isOk()){let t=e[0];return new _(t)}else return new g}function we(e,t,r){return e?t:r()}function J(e,t,r){return yr(t,r,e)}function Fn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=h(i,n)}}}function In(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return Fn(n,u([]));{let i=r.head;e=r.tail,t=h(i[0],n)}}}function Ke(e){let t=xe(e);return In(t,u([]))}function Je(e,t){return gr(t,e)}function jt(e,t,r){let i=le(e,t),s=Et(i),o=r(s);return(l=>J(e,t,l))(o)}function Gn(e,t){for(;;){let r=e,n=t;if(r.atLeastLength(1))e=r.tail,t=n+1;else return n}}function Tt(e){return Gn(e,0)}function Rn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=h(i,n)}}}function Y(e){return Rn(e,u([]))}function St(e){if(e.hasLength(0))return new p(void 0);{let t=e.head;return new f(t)}}function Un(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return Y(s);{let o=n.head;e=n.tail,t=i,r=h(i(o),s)}}}function S(e,t){return Un(e,t,u([]))}function Hn(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return new f(Y(s));{let o=n.head,l=n.tail,a=i(o);if(a.isOk()){let d=a[0];e=l,t=i,r=h(d,s)}else{let d=a[0];return new p(d)}}}}function Se(e,t){return Hn(e,t,u([]))}function Ar(e,t){for(;;){let r=e,n=t;if(n<=0)return r;if(r.hasLength(0))return u([]);e=r.tail,t=n-1}}function Kn(e,t){for(;;){let r=e,n=t;if(r.hasLength(0))return n;{let i=r.head;e=r.tail,t=h(i,n)}}}function ue(e,t){return Kn(Y(e),t)}function ne(e,t,r){for(;;){let n=e,i=t,s=r;if(n.hasLength(0))return i;{let o=n.head;e=n.tail,t=s(i,o),r=s}}}function Jn(e,t,r,n){for(;;){let i=e,s=t,o=r,l=n;if(i.hasLength(0))return s;{let a=i.head;e=i.tail,t=o(s,a,l),r=o,n=l+1}}}function Ct(e,t,r){return Jn(e,t,r,0)}function Qe(e,t){for(;;){let r=e,n=t;if(n>0){let s=Er(r);if(s.isOk())e=s[0][1],t=n-1;else return r}else return r}}function B(e,t){if(e.isOk()){let r=e[0];return new f(t(r))}else{let r=e[0];return new p(r)}}function tt(e,t){if(e.isOk()){let r=e[0];return new f(r)}else{let r=e[0];return new p(t(r))}}function Z(e,t){if(e.isOk()){let r=e[0];return t(r)}else{let r=e[0];return new p(r)}}function D(e,t){return Z(e,t)}function ye(e,t){if(e.isOk()){let r=e[0];return new f(r)}else return new p(t)}var N=class extends c{constructor(t,r,n){super(),this.expected=t,this.found=r,this.path=n}};function rt(e){return new f(e)}function qt(e){return Pr(e)}function pi(e){return zr(e)}function Cr(e,t){let r=e===1?"":"s",n=(()=>{let i=u(["Tuple of at least ",y(e)," element",r]),s=ie(i),o=s;return new N(o,Q(t),u([]))})();return new p(u([n]))}function Ne(e){return t=>{if(e.hasLength(0))return new p(u([new N("another type",Q(t),u([]))]));{let r=e.head,n=e.tail,i=r(t);if(i.isOk()){let s=i[0];return new f(s)}else return Ne(n)(t)}}}function zt(e,t){let r=t,n=Ne(u([ae,s=>B(qt(s),y)])),i=(()=>{let s=n(r);if(s.isOk())return s[0];{let o=u(["<",Q(r),">"]),l=ie(o);return l}})();return e.withFields({path:h(i,e.path)})}function Mr(e){return t=>Z(pi(t),r=>{let i=Se(r,e);return Ft(i,s=>zt(s,"*"))})}function Ft(e,t){return tt(e,r=>S(r,t))}function be(e,t){return r=>{let n=new N("field","nothing",u([]));return Z(Fr(r,e),i=>{let o=hr(i,u([n])),l=Z(o,t);return Ft(l,a=>zt(a,e))})}}function Nr(e,t){return r=>Z(qr(r),n=>{let i=Ze(n);return Z(e>=0?e<i?Pt(n,e):Cr(e+1,r):Me(e)<=i?Pt(n,i+e):Cr(Me(e),r),s=>{let o=t(s);return Ft(o,l=>zt(l,e))})})}var Ir=new WeakMap,It=new DataView(new ArrayBuffer(8)),Wt=0;function Bt(e){let t=Ir.get(e);if(t!==void 0)return t;let r=Wt++;return Wt===2147483647&&(Wt=0),Ir.set(e,r),r}function Dt(e,t){return e^t+2654435769+(e<<6)+(e>>2)|0}function Rt(e){let t=0,r=e.length;for(let n=0;n<r;n++)t=Math.imul(31,t)+e.charCodeAt(n)|0;return t}function Br(e){It.setFloat64(0,e);let t=It.getInt32(0),r=It.getInt32(4);return Math.imul(73244475,t>>16^t)^r}function di(e){return Rt(e.toString())}function _i(e){let t=Object.getPrototypeOf(e);if(t!==null&&typeof t.hashCode=="function")try{let n=e.hashCode(e);if(typeof n=="number")return n}catch{}if(e instanceof Promise||e instanceof WeakSet||e instanceof WeakMap)return Bt(e);if(e instanceof Date)return Br(e.getTime());let r=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||e instanceof Uint8Array)for(let n=0;n<e.length;n++)r=Math.imul(31,r)+P(e[n])|0;else if(e instanceof Set)e.forEach(n=>{r=r+P(n)|0});else if(e instanceof Map)e.forEach((n,i)=>{r=r+Dt(P(n),P(i))|0});else{let n=Object.keys(e);for(let i=0;i<n.length;i++){let s=n[i],o=e[s];r=r+Dt(P(o),Rt(s))|0}}return r}function P(e){if(e===null)return 1108378658;if(e===void 0)return 1108378659;if(e===!0)return 1108378657;if(e===!1)return 1108378656;switch(typeof e){case"number":return Br(e);case"string":return Rt(e);case"bigint":return di(e);case"object":return _i(e);case"symbol":return Bt(e);case"function":return Bt(e);default:return 0}}var te=5,Ut=Math.pow(2,te),$i=Ut-1,mi=Ut/2,hi=Ut/4,j=0,ee=1,M=2,de=3,Ht={type:M,bitmap:0,array:[]};function Pe(e,t){return e>>>t&$i}function it(e,t){return 1<<Pe(e,t)}function wi(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Kt(e,t){return wi(e&t-1)}function q(e,t,r){let n=e.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=e[s];return i[t]=r,i}function xi(e,t,r){let n=e.length,i=new Array(n+1),s=0,o=0;for(;s<t;)i[o++]=e[s++];for(i[o++]=r;s<n;)i[o++]=e[s++];return i}function Gt(e,t){let r=e.length,n=new Array(r-1),i=0,s=0;for(;i<t;)n[s++]=e[i++];for(++i;i<r;)n[s++]=e[i++];return n}function Dr(e,t,r,n,i,s){let o=P(t);if(o===n)return{type:de,hash:o,array:[{type:j,k:t,v:r},{type:j,k:i,v:s}]};let l={val:!1};return qe(Jt(Ht,e,o,t,r,l),e,n,i,s,l)}function qe(e,t,r,n,i,s){switch(e.type){case ee:return gi(e,t,r,n,i,s);case M:return Jt(e,t,r,n,i,s);case de:return yi(e,t,r,n,i,s)}}function gi(e,t,r,n,i,s){let o=Pe(r,t),l=e.array[o];if(l===void 0)return s.val=!0,{type:ee,size:e.size+1,array:q(e.array,o,{type:j,k:n,v:i})};if(l.type===j)return w(n,l.k)?i===l.v?e:{type:ee,size:e.size,array:q(e.array,o,{type:j,k:n,v:i})}:(s.val=!0,{type:ee,size:e.size,array:q(e.array,o,Dr(t+te,l.k,l.v,r,n,i))});let a=qe(l,t+te,r,n,i,s);return a===l?e:{type:ee,size:e.size,array:q(e.array,o,a)}}function Jt(e,t,r,n,i,s){let o=it(r,t),l=Kt(e.bitmap,o);if(e.bitmap&o){let a=e.array[l];if(a.type!==j){let x=qe(a,t+te,r,n,i,s);return x===a?e:{type:M,bitmap:e.bitmap,array:q(e.array,l,x)}}let d=a.k;return w(n,d)?i===a.v?e:{type:M,bitmap:e.bitmap,array:q(e.array,l,{type:j,k:n,v:i})}:(s.val=!0,{type:M,bitmap:e.bitmap,array:q(e.array,l,Dr(t+te,d,a.v,r,n,i))})}else{let a=e.array.length;if(a>=mi){let d=new Array(32),x=Pe(r,t);d[x]=Jt(Ht,t+te,r,n,i,s);let v=0,O=e.bitmap;for(let oe=0;oe<32;oe++){if(O&1){let z=e.array[v++];d[oe]=z}O=O>>>1}return{type:ee,size:a+1,array:d}}else{let d=xi(e.array,l,{type:j,k:n,v:i});return s.val=!0,{type:M,bitmap:e.bitmap|o,array:d}}}}function yi(e,t,r,n,i,s){if(r===e.hash){let o=Vt(e,n);if(o!==-1)return e.array[o].v===i?e:{type:de,hash:r,array:q(e.array,o,{type:j,k:n,v:i})};let l=e.array.length;return s.val=!0,{type:de,hash:r,array:q(e.array,l,{type:j,k:n,v:i})}}return qe({type:M,bitmap:it(e.hash,t),array:[e]},t,r,n,i,s)}function Vt(e,t){let r=e.array.length;for(let n=0;n<r;n++)if(w(t,e.array[n].k))return n;return-1}function nt(e,t,r,n){switch(e.type){case ee:return bi(e,t,r,n);case M:return ki(e,t,r,n);case de:return Ai(e,n)}}function bi(e,t,r,n){let i=Pe(r,t),s=e.array[i];if(s!==void 0){if(s.type!==j)return nt(s,t+te,r,n);if(w(n,s.k))return s}}function ki(e,t,r,n){let i=it(r,t);if(!(e.bitmap&i))return;let s=Kt(e.bitmap,i),o=e.array[s];if(o.type!==j)return nt(o,t+te,r,n);if(w(n,o.k))return o}function Ai(e,t){let r=Vt(e,t);if(!(r<0))return e.array[r]}function Yt(e,t,r,n){switch(e.type){case ee:return Li(e,t,r,n);case M:return vi(e,t,r,n);case de:return Oi(e,n)}}function Li(e,t,r,n){let i=Pe(r,t),s=e.array[i];if(s===void 0)return e;let o;if(s.type===j){if(!w(s.k,n))return e}else if(o=Yt(s,t+te,r,n),o===s)return e;if(o===void 0){if(e.size<=hi){let l=e.array,a=new Array(e.size-1),d=0,x=0,v=0;for(;d<i;){let O=l[d];O!==void 0&&(a[x]=O,v|=1<<d,++x),++d}for(++d;d<l.length;){let O=l[d];O!==void 0&&(a[x]=O,v|=1<<d,++x),++d}return{type:M,bitmap:v,array:a}}return{type:ee,size:e.size-1,array:q(e.array,i,o)}}return{type:ee,size:e.size,array:q(e.array,i,o)}}function vi(e,t,r,n){let i=it(r,t);if(!(e.bitmap&i))return e;let s=Kt(e.bitmap,i),o=e.array[s];if(o.type!==j){let l=Yt(o,t+te,r,n);return l===o?e:l!==void 0?{type:M,bitmap:e.bitmap,array:q(e.array,s,l)}:e.bitmap===i?void 0:{type:M,bitmap:e.bitmap^i,array:Gt(e.array,s)}}return w(n,o.k)?e.bitmap===i?void 0:{type:M,bitmap:e.bitmap^i,array:Gt(e.array,s)}:e}function Oi(e,t){let r=Vt(e,t);if(r<0)return e;if(e.array.length!==1)return{type:de,hash:e.hash,array:Gt(e.array,r)}}function Gr(e,t){if(e===void 0)return;let r=e.array,n=r.length;for(let i=0;i<n;i++){let s=r[i];if(s!==void 0){if(s.type===j){t(s.v,s.k);continue}Gr(s,t)}}}var ce=class e{static fromObject(t){let r=Object.keys(t),n=e.new();for(let i=0;i<r.length;i++){let s=r[i];n=n.set(s,t[s])}return n}static fromMap(t){let r=e.new();return t.forEach((n,i)=>{r=r.set(i,n)}),r}static new(){return new e(void 0,0)}constructor(t,r){this.root=t,this.size=r}get(t,r){if(this.root===void 0)return r;let n=nt(this.root,0,P(t),t);return n===void 0?r:n.v}set(t,r){let n={val:!1},i=this.root===void 0?Ht:this.root,s=qe(i,0,P(t),t,r,n);return s===this.root?this:new e(s,n.val?this.size+1:this.size)}delete(t){if(this.root===void 0)return this;let r=Yt(this.root,0,P(t),t);return r===this.root?this:r===void 0?e.new():new e(r,this.size-1)}has(t){return this.root===void 0?!1:nt(this.root,0,P(t),t)!==void 0}entries(){if(this.root===void 0)return[];let t=[];return this.forEach((r,n)=>t.push([n,r])),t}forEach(t){Gr(this.root,t)}hashCode(){let t=0;return this.forEach((r,n)=>{t=t+Dt(P(r),P(n))|0}),t}equals(t){if(!(t instanceof e)||this.size!==t.size)return!1;try{return this.forEach((r,n)=>{if(!w(t.get(n,!r),r))throw Wr}),!0}catch(r){if(r===Wr)return!1;throw r}}},Wr=Symbol();var st=void 0,Rr={};function se(e){return/^[-+]?(\d+)$/.test(e)?new f(parseInt(e)):new p(st)}function y(e){return e.toString()}var Ur;function ji(e){if(globalThis.Intl&&Intl.Segmenter)return Ur||=new Intl.Segmenter,Ur.segment(e)[Symbol.iterator]()}function Er(e){let t,r=ji(e);return r?t=r.next().value?.segment:t=e.match(/./su)?.[0],t?new f([t,e.slice(t.length)]):new p(st)}function ie(e){let t="";for(let r of e)t=t+r;return t}function Ze(e){return e.length}var Kr=[" ","	",`
`,"\v","\f","\r","\x85","\u2028","\u2029"].join(""),il=new RegExp(`^[${Kr}]*`),sl=new RegExp(`[${Kr}]*$`);function E(){return ce.new()}function xe(e){return T.fromArray(e.entries())}function gr(e,t){return t.delete(e)}function le(e,t){let r=e.get(t,Rr);return r===Rr?new p(st):new f(r)}function yr(e,t,r){return r.set(e,t)}function Q(e){if(typeof e=="string")return"String";if(typeof e=="boolean")return"Bool";if(e instanceof he)return"Result";if(e instanceof T)return"List";if(e instanceof He)return"BitArray";if(e instanceof ce)return"Dict";if(Number.isInteger(e))return"Int";if(Array.isArray(e))return`Tuple of ${e.length} elements`;if(typeof e=="number")return"Float";if(e===null)return"Null";if(e===void 0)return"Nil";{let t=typeof e;return t.charAt(0).toUpperCase()+t.slice(1)}}function ze(e,t){return Ti(e,Q(t))}function Ti(e,t){return new p(T.fromArray([new N(e,t,T.fromArray([]))]))}function ae(e){return typeof e=="string"?new f(e):ze("String",e)}function Pr(e){return Number.isInteger(e)?new f(e):ze("Int",e)}function qr(e){return Array.isArray(e)?new f(e):ze("Tuple",e)}function Pt(e,t){return t>=0&&e.length>t?new f(e[t]):new p(st)}function zr(e){return Array.isArray(e)?new f(T.fromArray(e)):e instanceof T?new f(e):ze("List",e)}function Fr(e,t){let r=()=>ze("Dict",e);if(e instanceof ce||e instanceof WeakMap||e instanceof Map){let n=le(e,t);return new f(n.isOk()?new _(n[0]):new g)}else return e===null?r():Object.getPrototypeOf(e)==Object.prototype?Hr(e,t,()=>new f(new g)):Hr(e,t,r)}function Hr(e,t,r){try{return t in e?new f(new _(e[t])):r()}catch{return r()}}function Me(e){return e>=0?e:e*-1}var Qt=class extends c{constructor(t){super(),this.dict=t}};function Zr(){return new Qt(E())}function Qi(e,t){return r=>Z(Mr(rt)(r),n=>{if(e>=0){let o=Ar(n,e),l=St(o),a=ye(l,u([new N("A list with at least"+y(e+1)+"elements","A list with"+y(Tt(n))+"elements",u([y(e)]))]));return D(a,t)}else return new p(u([new N("An 'index' decoder with a non-negative index",y(e),u([]))]))})}function es(e,t){return Ne(u([Nr(e,t),be(y(e),t),Qi(e,t)]))}function er(e,t,r){if(e.hasLength(0))return t(r);{let n=e.head,i=e.tail,s=se(n);if(s.isOk()){let o=s[0],l=r,a=es(o,rt)(l);return D(a,d=>er(i,t,d))}else{let o=r,l=be(n,rt)(o);return D(l,a=>er(i,t,a))}}}function Qr(e,t){return r=>er(e,t,r)}var Fe=class extends c{constructor(t){super(),this.all=t}};function en(e){return new Fe(u([t=>e(t.dispatch,t.emit,t.select,t.root)]))}function tn(e){return en((t,r,n,i)=>e(t))}function fe(){return new Fe(u([]))}function rn(e){return new Fe(ne(e,u([]),(t,r)=>{let n=r.all;return ue(t,n)}))}var ke=class extends c{constructor(t){super(),this.content=t}},b=class extends c{constructor(t,r,n,i,s,o,l){super(),this.key=t,this.namespace=r,this.tag=n,this.attrs=i,this.children=s,this.self_closing=o,this.void=l}},_e=class extends c{constructor(t){super(),this.subtree=t}},Ae=class extends c{constructor(t,r,n){super(),this[0]=t,this[1]=r,this.as_property=n}},Ie=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}};function us(e){if(e instanceof Ae)return new p(void 0);{let t=e[0],r=e[1],n=Qe(t,2);return new f([n,r])}}function as(e,t,r){return Ct(e,t,(n,i,s)=>{let o=r+"-"+y(s);return nn(i,n,o)})}function nn(e,t,r){for(;;){let n=e,i=t,s=r;if(n instanceof ke)return i;if(n instanceof _e){let o=n.subtree;e=o(),t=i,r=s}else{let o=n.attrs,l=n.children,a=ne(o,i,(d,x)=>{let v=us(x);if(v.isOk()){let O=v[0][0],oe=v[0][1];return J(d,s+"-"+O,oe)}else return d});return as(l,a,s)}}}function sn(e){return nn(e,E(),"0")}function ut(e,t){return new Ae(e,t,!1)}function ln(e,t){return new Ie("on"+e,t)}function $e(e){return ut("style",ne(e,"",(t,r)=>{let n=r[0],i=r[1];return t+n+":"+i+";"}))}function un(e){return ut("type",e)}function an(e){return ut("value",e)}function cn(e){return ut("min",e)}function Le(e,t,r){return e==="area"?new b("","",e,t,u([]),!1,!0):e==="base"?new b("","",e,t,u([]),!1,!0):e==="br"?new b("","",e,t,u([]),!1,!0):e==="col"?new b("","",e,t,u([]),!1,!0):e==="embed"?new b("","",e,t,u([]),!1,!0):e==="hr"?new b("","",e,t,u([]),!1,!0):e==="img"?new b("","",e,t,u([]),!1,!0):e==="input"?new b("","",e,t,u([]),!1,!0):e==="link"?new b("","",e,t,u([]),!1,!0):e==="meta"?new b("","",e,t,u([]),!1,!0):e==="param"?new b("","",e,t,u([]),!1,!0):e==="source"?new b("","",e,t,u([]),!1,!0):e==="track"?new b("","",e,t,u([]),!1,!0):e==="wbr"?new b("","",e,t,u([]),!1,!0):new b("","",e,t,r,!1,!1)}function fn(e,t){if(e instanceof b){let r=e.namespace,n=e.tag,i=e.attrs,s=e.children,o=e.self_closing,l=e.void;return new b(t,r,n,i,s,o,l)}else if(e instanceof _e){let r=e.subtree;return new _e(()=>fn(r(),t))}else return e}function pn(e,t){return e(S(t,r=>{let n=r[0],i=r[1];return fn(i,n)}))}function dn(e){return new ke(e)}var at=class extends c{constructor(t){super(),this[0]=t}},ct=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}},ft=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}};function $n(e){return w(e.created,E())&&w(e.removed,Zr())&&w(e.updated,E())}var pt=class extends c{constructor(t){super(),this[0]=t}},dt=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}},We=class extends c{constructor(t){super(),this[0]=t}},R=class extends c{constructor(t){super(),this[0]=t}},Be=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}},_t=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}};var ve=class extends c{},$t=class extends c{constructor(t,r){super(),this[0]=t,this[1]=r}},mt=class extends c{constructor(t){super(),this[0]=t}},ht=class extends c{constructor(t){super(),this[0]=t}};globalThis.customElements&&!globalThis.customElements.get("lustre-fragment")&&globalThis.customElements.define("lustre-fragment",class extends HTMLElement{constructor(){super()}});function rr(e,t,r){let n,i=[{prev:e,next:t,parent:e.parentNode}];for(;i.length;){let{prev:s,next:o,parent:l}=i.pop();for(;o.subtree!==void 0;)o=o.subtree();if(o.content!==void 0)if(s)if(s.nodeType===Node.TEXT_NODE)s.textContent!==o.content&&(s.textContent=o.content),n??=s;else{let a=document.createTextNode(o.content);l.replaceChild(a,s),n??=a}else{let a=document.createTextNode(o.content);l.appendChild(a),n??=a}else if(o.tag!==void 0){let a=ps({prev:s,next:o,dispatch:r,stack:i});s?s!==a&&l.replaceChild(a,s):l.appendChild(a),n??=a}}return n}function ps({prev:e,next:t,dispatch:r,stack:n}){let i=t.namespace||"http://www.w3.org/1999/xhtml",s=e&&e.nodeType===Node.ELEMENT_NODE&&e.localName===t.tag&&e.namespaceURI===(t.namespace||"http://www.w3.org/1999/xhtml"),o=s?e:i?document.createElementNS(i,t.tag):document.createElement(t.tag),l;if(De.has(o))l=De.get(o);else{let $=new Map;De.set(o,$),l=$}let a=s?new Set(l.keys()):null,d=s?new Set(Array.from(e.attributes,$=>$.name)):null,x=null,v=null,O=null;if(s&&t.tag==="textarea"){let $=t.children[Symbol.iterator]().next().value?.content;$!==void 0&&(o.value=$)}let oe=[];for(let $ of t.attrs){let m=$[0],L=$[1];if($.as_property)o[m]!==L&&(o[m]=L),s&&d.delete(m);else if(m.startsWith("on")){let U=m.slice(2),vt=r(L,U==="input");l.has(U)||o.addEventListener(U,Ge),l.set(U,vt),s&&a.delete(U)}else if(m.startsWith("data-lustre-on-")){let U=m.slice(15),vt=r(ds);l.has(U)||o.addEventListener(U,Ge),l.set(U,vt),o.setAttribute(m,L),s&&(a.delete(U),d.delete(m))}else m.startsWith("delegate:data-")||m.startsWith("delegate:aria-")?(o.setAttribute(m,L),oe.push([m.slice(10),L])):m==="class"?x=x===null?L:x+" "+L:m==="style"?v=v===null?L:v+L:m==="dangerous-unescaped-html"?O=L:(o.getAttribute(m)!==L&&o.setAttribute(m,L),(m==="value"||m==="selected")&&(o[m]=L),s&&d.delete(m))}if(x!==null&&(o.setAttribute("class",x),s&&d.delete("class")),v!==null&&(o.setAttribute("style",v),s&&d.delete("style")),s){for(let $ of d)o.removeAttribute($);for(let $ of a)l.delete($),o.removeEventListener($,Ge)}if(t.tag==="slot"&&window.queueMicrotask(()=>{for(let $ of o.assignedElements())for(let[m,L]of oe)$.hasAttribute(m)||$.setAttribute(m,L)}),t.key!==void 0&&t.key!=="")o.setAttribute("data-lustre-key",t.key);else if(O!==null)return o.innerHTML=O,o;let z=o.firstChild,dr=null,_r=null,$r=null,Lt=wt(t).next().value;if(s&&Lt!==void 0&&Lt.key!==void 0&&Lt.key!==""){dr=new Set,_r=mn(e),$r=mn(t);for(let $ of wt(t))z=_s(z,$,o,n,$r,_r,dr)}else for(let $ of wt(t))n.unshift({prev:z,next:$,parent:o}),z=z?.nextSibling;for(;z;){let $=z.nextSibling;o.removeChild(z),z=$}return o}var De=new WeakMap;function Ge(e){let t=e.currentTarget;if(!De.has(t)){t.removeEventListener(e.type,Ge);return}let r=De.get(t);if(!r.has(e.type)){t.removeEventListener(e.type,Ge);return}r.get(e.type)(e)}function ds(e){let t=e.currentTarget,r=t.getAttribute(`data-lustre-on-${e.type}`),n=JSON.parse(t.getAttribute("data-lustre-data")||"{}"),i=JSON.parse(t.getAttribute("data-lustre-include")||"[]");switch(e.type){case"input":case"change":i.push("target.value");break}return{tag:r,data:i.reduce((s,o)=>{let l=o.split(".");for(let a=0,d=s,x=e;a<l.length;a++)a===l.length-1?d[l[a]]=x[l[a]]:(d[l[a]]??={},x=x[l[a]],d=d[l[a]]);return s},{data:n})}}function mn(e){let t=new Map;if(e)for(let r of wt(e)){let n=r?.key||r?.getAttribute?.("data-lustre-key");n&&t.set(n,r)}return t}function _s(e,t,r,n,i,s,o){for(;e&&!i.has(e.getAttribute("data-lustre-key"));){let a=e.nextSibling;r.removeChild(e),e=a}if(s.size===0)return n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e;if(o.has(t.key))return console.warn(`Duplicate key found in Lustre vnode: ${t.key}`),n.unshift({prev:null,next:t,parent:r}),e;o.add(t.key);let l=s.get(t.key);if(!l&&!e)return n.unshift({prev:null,next:t,parent:r}),e;if(!l&&e!==null){let a=document.createTextNode("");return r.insertBefore(a,e),n.unshift({prev:a,next:t,parent:r}),e}return!l||l===e?(n.unshift({prev:e,next:t,parent:r}),e=e?.nextSibling,e):(r.insertBefore(l,e),n.unshift({prev:l,next:t,parent:r}),e)}function*wt(e){for(let t of e.children)yield*hn(t)}function*hn(e){e.subtree!==void 0?yield*hn(e.subtree()):yield e}var nr=class e{static start({init:t,update:r,view:n},i,s){if(!sr())return new p(new Re);let o=i instanceof HTMLElement?i:document.querySelector(i);if(!o)return new p(new xt(i));let l=new e(o,t(s),r,n);return new f(a=>l.send(a))}constructor(t,[r,n],i,s){this.root=t,this.#e=r,this.#s=i,this.#r=s,this.#t=window.requestAnimationFrame(()=>this.#n(n.all.toArray(),!0))}root;send(t){if(t instanceof We){if(t[0]instanceof ht){this.#t=window.cancelAnimationFrame(this.#t),this.#i=[],this.#e=t[0][0];let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let a=s(l);a instanceof f&&this.send(new R(a[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));rr(i,r,n)}}else if(t instanceof R){let r=t[0],n=t[1]??!1;this.#i.push(r),n?(this.#t=window.cancelAnimationFrame(this.#t),this.#n()):this.#t||(this.#t=window.requestAnimationFrame(()=>this.#n()))}else if(t instanceof Be){let r=t[0],n=t[1];this.root.dispatchEvent(new CustomEvent(r,{detail:n,bubbles:!0,composed:!0}))}else if(t instanceof ve)for(this.#t=window.cancelAnimationFrame(this.#t),this.#e=null,this.#s=null,this.#r=null,this.#i=null;this.root.firstChild;)this.root.firstChild.remove()}#e;#s;#r;#i=[];#t;#n(t=[]){this.#t=void 0,this.#o(t);let r=this.#r(this.#e),n=(s,o=!1)=>l=>{let a=s(l);a instanceof f&&this.send(new R(a[0],o))},i=this.root.firstChild??this.root.appendChild(document.createTextNode(""));rr(i,r,n)}#o(t=[]){for(;this.#i.length>0;){let r=this.#i.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;){let r=t.shift(),n=l=>this.send(new R(l)),i=(l,a)=>this.root.dispatchEvent(new CustomEvent(l,{detail:a,bubbles:!0,composed:!0})),s=()=>{},o=this.root;r({dispatch:n,emit:i,select:s,root:o})}this.#i.length>0&&this.#o(t)}},wn=nr.start;var ir=class e{static start({init:t,update:r,view:n,on_attribute_change:i},s){let o=new e(t(s),r,n,i);return new f(l=>o.send(l))}constructor([t,r],n,i,s){this.#e=t,this.#s=n,this.#i=i,this.#t=i(t),this.#u=s,this.#n=new Map,this.#o=sn(this.#t),this.#l(r.all.toArray())}send(t){if(t instanceof pt){for(let r of t[0]){let n=this.#u.get(r[0]);if(!n)continue;let i=n(r[1]);i instanceof p||this.#r.push(i)}this.#l()}else if(t instanceof dt)this.#r=this.#r.concat(t[0].toArray()),this.#l(t[1].all.toArray());else if(!(t instanceof We))if(t instanceof R)this.#r.push(t[0]),this.#l();else if(t instanceof Be){let r=new ct(t[0],t[1]);for(let[n,i]of this.#n)i(r)}else if(t instanceof _t){let r=this.#o.get(t[0]);if(!r)return;let n=r(t[1]);if(n instanceof p)return;this.#r.push(n[0]),this.#l()}else if(t instanceof $t){let r=Ke(this.#u),n=new ft(r,this.#t);this.#n=this.#n.set(t[0],t[1]),t[1](n)}else t instanceof mt&&(this.#n=this.#n.delete(t[0]))}#e;#s;#r;#i;#t;#n;#o;#u;#l(t=[]){this.#a(t);let r=this.#i(this.#e),n=elements(this.#t,r);if(!$n(n)){let i=new at(n);for(let[s,o]of this.#n)o(i)}this.#t=r,this.#o=n.handlers}#a(t=[]){for(;this.#r.length>0;){let r=this.#r.shift(),[n,i]=this.#s(this.#e,r);t=t.concat(i.all.toArray()),this.#e=n}for(;t.length>0;)t.shift()({dispatch:l=>this.send(new R(l)),emit:(l,a)=>this.root.dispatchEvent(new CustomEvent(l,{detail:a,bubbles:!0,composed:!0})),select:()=>{},root:null});this.#r.length>0&&this.#a(t)}},$s=ir.start,sr=()=>globalThis.window&&window.document;var or=class extends c{constructor(t,r,n,i){super(),this.init=t,this.update=r,this.view=n,this.on_attribute_change=i}};var xt=class extends c{constructor(t){super(),this.selector=t}},Re=class extends c{};function xn(e,t,r){return new or(e,t,r,new g)}function gn(e){return new R(e)}function yn(){return new ve}function bn(e,t,r){return we(!sr(),new p(new Re),()=>wn(e,t,r))}function gt(e){return dn(e)}function Oe(e,t){return Le("div",e,t)}function kn(e,t){return Le("span",e,t)}function lr(e,t){return Le("button",e,t)}function ur(e){return Le("input",e,u([]))}function yt(e,t){return ln(e,t)}function An(e){let t=e;return be("target",be("value",ae))(t)}function ar(e){let t=document.querySelector(e);return t?new f(t):new p}function cr(e,t,r){return e.addEventListener(t,r)}var fr=class extends c{constructor(t){super(),this[0]=t}},bt=class extends c{constructor(t){super(),this.name=t}},pr=class extends c{},kt=class extends c{constructor(t,r){super(),this.name=t,this.amount=r}},At=class extends c{constructor(t){super(),this.signal=t}};function bs(e){let t=E(),r=fe();return[t,r]}function ks(e,t){if(t instanceof fr)return[e,fe()];if(t instanceof bt){let r=t.name;return[jt(e,r,n=>n instanceof _?n[0]+1:1),fe()]}else{if(t instanceof pr)return[e,fe()];if(t instanceof kt){let r=t.name,n=t.amount;return[n===0?Je(e,r):J(e,r,n),fe()]}else{let r=t.signal;return[E(),rn(u([r]))]}}}function As(){let e=t=>{let r=u(["target","previousElementSibling","value"]),n=t,i=Qr(r,ae)(n);return B(i,s=>new bt(s))};return Oe(u([]),u([ur(u([])),lr(u([yt("click",e)]),u([gt("Add")]))]))}function Ls(e,t){let r=n=>{let i=An(n),s=ye(i,void 0),o=D(s,se),l=B(o,a=>new kt(e,a));return ye(l,u([]))};return Oe(u([$e(u([["display","flex"],["gap","1em"]]))]),u([kn(u([$e(u([["flex","1"]]))]),u([gt(e)])),ur(u([$e(u([["width","4em"]])),un("number"),an(y(t)),cn("0"),yt("input",r)]))]))}function vs(e){let t=u([["display","flex"],["flex-direction","column-reverse"]]);return pn(r=>Oe(u([$e(t)]),r),S(xe(e),r=>{let n=r[0],i=r[1],s=Ls(n,i);return[n,s]}))}function Os(e){let t=u([["max-width","30ch"],["margin","0 auto"],["display","flex"],["flex-direction","column"],["gap","1em"]]),r=n=>new f(new At(fe()));return Oe(u([$e(t)]),u([vs(e),As(),Oe(u([]),u([lr(u([yt("click",r)]),u([gt("Sync")]))]))]))}var Ln="#client";function vn(){let e=xn(bs,ks,Os),t=bn(e,Ln,void 0);if(!t.isOk())throw pe("let_assert","client",22,"main","Pattern match failed, no pattern matched the value.",{value:t});let r=t[0],n=tn(s=>{let o=yn();return r(o)}),i=ar(Ln);if(i.isOk()){let s=i[0];cr(s,"htmx:BeforeSwap",o=>{let l=new At(n),a=gn(l);return r(a)})}}vn();
